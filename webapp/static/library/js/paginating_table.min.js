var PaginatingTable=new Class({Implements:Options,options:{per_page:10,current_page:1,offset_el:false,cutoff_el:false,details:false},initialize:function(c,b,a){this.table=$(c);this.setOptions(a);this.tbody=this.table.getElement("tbody");if(this.options.offset_el){this.options.offset_el=$(this.options.offset_el)}if(this.options.cutoff_el){this.options.cutoff_el=$(this.options.cutoff_el)}this.paginators=($type(b)=="array")?b.map($):[$(b)];if(this.options.details){this.options.per_page=this.options.per_page*2}this.update_pages()},update_pages:function(){this.pages=Math.ceil(this.tbody.getChildren().length/this.options.per_page);this.create_pagination();this.to_page(1)},to_page:function(d){d=d.toInt();if(d>this.pages||d<1){return}this.current_page=d;this.low_limit=this.options.per_page*(this.current_page-1);this.high_limit=this.options.per_page*this.current_page;var a=this.tbody.getChildren();if(a.length<this.high_limit){this.high_limit=a.length}for(var c=0,b=a.length;c<b;c++){a[c].style.display=(this.low_limit<=c&&this.high_limit>c)?"":"none"}this.paginators.each(function(f){var e=f.getElements("a").removeClass("currentPage");e[this.current_page].addClass("currentPage")},this);if(this.options.offset_el){this.options.offset_el.set("text",Math.ceil(this.low_limit/(this.options.details?2:1)+1))}if(this.options.cutoff_el){this.options.cutoff_el.set("text",(this.high_limit/(this.options.details?2:1)))}},to_next_page:function(){this.to_page(this.current_page+1)},to_prev_page:function(){this.to_page(this.current_page-1)},create_pagination:function(){this.paginators.each(function(b){b.empty();this.create_pagination_node("&#171;",function(c){var c=new Event(c);this.to_prev_page();c.stop();return false}).injectInside(b);for(var a=1;a<=this.pages;a++){this.create_pagination_node(a,function(c){var c=new Event(c);this.to_page(c.target.get("text"));c.stop();return false}).injectInside(b)}this.create_pagination_node("&#187;",function(c){var c=new Event(c);this.to_next_page();c.stop();return false}).injectInside(b)}.bind(this))},create_pagination_node:function(f,d){var e=new Element("span").set("html",f);if(f=="&#171;"){var c=new Element("a",{href:"#","class":"previous-page"}).addEvent("click",d.bind(this))}else{if(f=="&#187;"){var c=new Element("a",{href:"#","class":"next-page"}).addEvent("click",d.bind(this))}else{var c=new Element("a",{href:"#"}).addEvent("click",d.bind(this))}}var b=new Element("li");e.injectInside(c.injectInside(b));return b}});